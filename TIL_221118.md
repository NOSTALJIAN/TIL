# â¤ï¸â€ğŸ”¥ **TIL DAY 09** â¤ï¸â€ğŸ”¥

> ğŸ“† 2022ë…„ 11ì›” 18ì¼ ê¸ˆìš”ì¼

<br>

---

<br>

ì–´ì œ ìƒˆë²½ 4ì‹œ ë„˜ì–´ì„œê¹Œì§€ ëª»ì¤ë‹¤... <br>
Java main class not Found Error ë•Œë¬¸ì—.. <br>
í”¼ê³¤í•´ì„œ ì£½ì„ê±°ê°™ì• ... <br>
ì›ë˜ ì ì‹¬ì¯¤ì´ë©´ ëª»ì¤ì–´ë„ ì¢€ ìŒ©ìŒ©í•´ì§€ëŠ”ë°... <br>
DB ë¶€ë¶„ ëª»ë”°ë¼ê°€ì„œ ìˆ˜ì—… ë‚´ìš©ë„ ëª»ì•Œì•„ë“£ê² ìŒ.. <br>
ì£¼ë§ë™ì•ˆ Javaë‘ DB ë¶€ë¶„ ë¹¡ê³µí•´ì•¼í•¨ ã…œã…œ ğŸ˜­ğŸ˜­ <br>

<br>

---

<br>

## ğŸ’¡ JDBC

> DBì™€ ì—°ê²°í•´ì„œ ë°ì´í„° ì…ì¶œë ¥ ì‘ì—…ì„ í•  ìˆ˜ ìˆë„ë¡ Javaì—ì„œ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
> JDBC: Java Database Connectivity

<br>

### â“ DriverManager

- **JDBC Driver**ë¥¼ ê´€ë¦¬
- DBì™€ ì—°ê²°í•´ì„œ **`Connection` êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±**

<br>

### â“ Connection

- `Statement`, `PreparedStatement`, `CallableStatement` êµ¬í˜„ê°ì²´ ìƒì„±
- íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë° DB ì—°ê²°ì„ ëŠì„ ë•Œ ì‚¬ìš©

<br>

### â“ Statement

- **SQL**ì˜ DDLê³¼ DMLì„ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©
  - DDL: Data Definition Language
  - DML: Data Manipulation Language
- ì£¼ë¡œ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì •ì  SQLë¬¸ì„ ì‹¤í–‰í•  ë–„ ì‚¬ìš©

<Br>

### â“ PreparedStatement

- Statementì™€ ë™ì¼í•˜ê²Œ SQLì˜ DDLê³¼ DML ë¬¸ì„ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©
- **ë§¤ê°œë³€ìˆ˜í™”ëœ SQLë¬¸ ì‚¬ìš© ê°€ëŠ¥**
- í¸ë¦¬ì„±ê³¼ ë³´ì•ˆì„±ì´ ì¢‹ìŒ
- Statement ë³´ë‹¤ ì£¼ë¡œ ì‚¬ìš©ë¨

<br>

### â“ CallableStatement

- DBì— ì €ì¥ë˜ì–´ ìˆëŠ” í”„ë¡œì‹œì €(procuder)ì™€ í•¨ìˆ˜(function)ì„ í˜¸ì¶œí•  ë•Œ ì‚¬ìš©

<br>

### â“ ResultSet

- DBì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ ì½ì„ ë•Œ ì‚¬ìš©

<br>

---

<br>

## ğŸ’¡ DB ì—°ê²°

<br>

### ğŸ“ JDBC Driver ë¡œë”©

> í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë¨ì„ DBì™€ ì—°ê²°í•˜ê¸° ìœ„í•´ ê°€ì¥ ë¨¼ì € í•´ì•¼ í•  ì‘ì—…

    Class.forName("com.mysql.cj.jdbc.Driver");

- Class.forName() ë©”ì†Œë“œëŠ” ë¬¸ìì—´ë¡œ ì£¼ì–´ì§„ JDBC Driver í´ë˜ìŠ¤ë¥¼ Build Pathì—ì„œ ì°¾ê³ , ë©”ëª¨ë¦¬ë¡œ ë¡œë”©í•¨
- ì´ ê³¼ì •ì—ì„œ JDBC Driver í´ë˜ìŠ¤ì˜ static ë¸”ë¡ì´ ì‹¤í–‰ë¨
- DriverManagerì—ã…” JDBC Driver ê°ì²´ê°€ ë“±ë¡ë¨
- Build Pathì—ì„œ JDBC Driver í´ë˜ìŠ¤ë¥¼ ëª»ì°¾ìœ¼ë©´ ClassNotFoundException ë°œìƒ
- ì˜ˆì™¸ì²˜ë¦¬ í•´ì•¼í•¨

<br>

    Connection conn = DriverManager.getConnection("ì—°ê²° ë¬¸ìì—´", "ì‚¬ìš©ì", "ë¹„ë°€ë²ˆí˜¸");

- DriverManagerì— JDBC Driverê°€ ë“±ë¡ë˜ë©´ getConnection() ë©”ì†Œë“œë¡œ DBì™€ ì—°ê²° ê°€ëŠ¥

<br>

    jdbc:mysql://localhost:3306/'DB(Database)ì´ë¦„'

- MySQLì˜ ì—°ê²° ë¬¸ìì—´
- localhost : ë¡œì»¬ì— ì„¤ì¹˜ëœ MySQLì— ì—°ê²°í•˜ê² ë‹¤ëŠ” ì˜ë¯¸
- 3306 : Port ë²ˆí˜¸
- ë§ˆì§€ë§‰ì—” DB ì´ë¦„ì„ ê¸°ì…

<br>

ì—°ê²°ì´ ì„±ê³µí•˜ë©´ getConnection() ë©”ì†Œë“œëŠ” Connection ê°ì²´ë¥¼ ë¦¬í„´
ì—°ê²°ì´ ì‹¤íŒ¨í•˜ë©´ SQLExceptionì´ ë°œìƒí•˜ë¯€ë¡œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•´ì•¼í•¨

<br>

[ğŸ”— DB Connection Example](https://github.com/NOSTALJIAN/JAVA/blob/d615d5f973797565fcf52063d6d8751f1c26b15a/Jian/jdbc/day01/ConnectionExample.java)

<br>

---

<br>

## ğŸ’¡ ë°ì´í„° ì €ì¥

> **JDBC**ë¥¼ ì´ìš©í•´ì„œ `INSERTë¬¸` ì‹¤í–‰

<br>

### ğŸ“ users í…Œì´ë¸”ì— ìƒˆë¡œìš´ ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” `INSERT`ë¬¸


    INSERT INTO users (userID, userName, userPassword, userAge, userEmail)
    VALUES ('winter', 'í•œê²¨ìš¸', '12345', '25', 'winter@mycompany.com')

<br>

- 1ï¸âƒ£ ê°’ì„ **`?`**(ë¬¼ìŒí‘œ)ë¡œ ëŒ€ì²´í•´ì„œ ë§¤ê°œë³€ìˆ˜í™”

      INSERT INTO users (userID, userName, userPassword, userAge, userEmail)
      VALUES (?, ?, ?, ?, ?)

<br>

- 2ï¸âƒ£ INSERTë¬¸ì„ String íƒ€ì… ë³€ìˆ˜ **`sql`** ì— ë¬¸ìì—´ë¡œ ëŒ€ì…

      String sql = new StringBuilder()
        .append("INSERT INTO users (userID, userName, userPassword, userEmail) ")
        .append("VALUES (?, ?, ?, ?, ?)")
        .toString();

      OR

      String sql = "" +
        "INSERT INTO users (userID, userName, userPassword, userEmail) " +
        "VALUES (?, ?, ?, ?, ?)";

<br>

- 3ï¸âƒ£ ë§¤ê°œë³€ìˆ˜í™”ëœ SQL ë¬¸ì„ ì‹¤í–‰í•˜ë ¤ë©´ **`PreparedStatement`** ê°€ í•„ìš”í•¨

      PreparedStatement pstmt = conn.prepareStatement(sql);
  - **Connection**ì˜ **prepareStatement()** ë©”ì†Œë“œë¡œë¶€í„° **PreparedStatement**ë¥¼ ì–»ê¸°

<br>

- 4ï¸âƒ£ **`?`** ì— ë“¤ì–´ê°ˆ ê°’ ì§€ì •

      pstmt.setString(1, "winter");
      pstmt.setString(2, "í•œê²¨ìš¸");
      pstmt.setString(3, "12345");
      pstmt.setString(4, 25);
      pstmt.setString(5, "winter@mycompany.com");
  - **`?`** ëŠ” **ìˆœì„œ**ì— ë”°ë¼ **1**ë²ˆë¶€í„° ë²ˆí˜¸ê°€ ë¶€ì—¬ë¨
  - **ê°’**ì˜ **íƒ€ì…**ì— ë”°ë¼ Setter ë©”ì†Œë“œ ì„ íƒ
  - ì²« ë²ˆì§¸ì—ëŠ” `?`ì˜ ìˆœë²ˆ, ë‘ ë²ˆì§¸ì—ëŠ” ê°’ì„ ì§€ì •

<br>

- 5ï¸âƒ£ ê°’ì„ ì§€ì •í•œ í›„ **`executeUpdate()`** ë©”ì†Œë“œ í˜¸ì¶œ

      int rows = pstmt.executeUpdate();
  - SQLë¬¸ì´ ì‹¤í–‰ë˜ë©´ì„œ **users** í…Œì´ë¸”ì— 1ê°œì˜ í–‰ì´ ì €ì¥ë¨
  - **executeUpdate()** ë©”ì†Œë“œê°€ **ë¦¬í„´**í•˜ëŠ” ê°’ì€ **ì €ì¥ëœ í–‰ ìˆ˜**
    - ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆì„ ê²½ìš° 1ì„ ë¦¬í„´

<br>

- 6ï¸âƒ£ **`close()`** ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•´ì„œ ë©”ëª¨ë¦¬ í•´ì œ

      pstmt.close();
  - **PreparedStatement**ë¥¼ ë” ì´ìƒ **ì‚¬ìš©í•˜ì§€ ì•Šì„** ê²½ìš°

<br>

[ğŸ”— UserInsertExample](https://github.com/NOSTALJIAN/JAVA/blob/b36db64ce973bb6ecab78d9426b3bcec6b3109ad/Jian/jdbc/day01/UserInsertExample.java)

<br>

![userí…Œì´ë¸”_ì ìš©ì‚¬ì§„_MySQL](/IMAGE/thisisjava_users.png)

<br>

---

<br>

### ğŸ“ boards í…Œì´ë¸”ì— ê²Œì‹œë¬¼ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” `INSERT`ë¬¸

    INSERT INTO boards (btitle, bcontent, bwriter, bdate, bfilename, bfiledata)
    VALUES ('ëˆˆ ì˜¤ëŠ” ë‚ ', 'í•¨ë°•ëˆˆì´ ë‚´ë ¤ìš”', 'winter', now(), 'snow.jpg', binaryData)

- `bno`ëŠ” ìë™ ì¦ê°€ ì»¬ëŸ¼ì´ë¯€ë¡œ ìƒëµ
- `now()`ëŠ” í˜„ì¬ ì‹œê°„

<br>

- 1ï¸âƒ£ **`now()`ë¥¼ ì œì™¸**í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” **`?`ë¡œ ëŒ€ì²´**ì‹œì¼œ **ë§¤ê°œë³€ìˆ˜í™”** ì‹œí‚¤ê³  String íƒ€ì… ë³€ìˆ˜ **`sql`** ì— ì €ì¥

      String sql = "" +
        "INSERT INTO boards (btitle, bcontent, bwriter, bdate, bfilename, bfiledata) " +
        "VALUES (?, ?, ?, now(), ?, ?)";

<br>

- 2ï¸âƒ£ **`PreparedStatement`** ì–»ê¸°

      PreparedStatement pstmt = conn.prepareStatement(sql,
                                Statement.RETURN_GENERATED_KEYS);
  - ë‘ë²ˆì§¸ ë§¤ê°œê°’ì€ **INSERT ë¬¸ì´ ì‹¤í–‰ëœ í›„** ê°€ì ¸ì˜¬ í‚¤ ê°’
    - ìë™ ì¦ê°€ëœ `bno`ê°’ì„ ê°€ì ¸ì˜´
    - `SQL`ë¬¸ì´ ì‹¤í–‰ë˜ê¸° **ì „**ì—ëŠ” `bno` ê°’ì„ **ëª¨ë¦„**
    - `SQL`ë¬¸ì´ ì‹¤í–‰ëœ **í›„**ì— `bno` ì»¬ëŸ¼ì— **ì‹¤ì œë¡œ ì €ì¥ëœ** ê°’ì„ ì–»ëŠ” ê²ƒ

<br>

- 3ï¸âƒ£ **`?`** ê°’ ì§€ì •

      pstmt.setString(1, "ëˆˆ ì˜¤ëŠ” ë‚ ");
      pstmt.setString(2, "í•¨ë°•ëˆˆì´ ë‚´ë ¤ìš”.");
      pstmt.setString(3, "winter");
      pstmt.setString(4, "snow.jpg");
      pstmt.setBlob(5, new FileInputStream("ëˆˆ ì‚¬ì§„ ê²½ë¡œ"));
  - `bfiledata` ì»¬ëŸ¼ì€ ë°”ì´ë„ˆë¦¬ íƒ€ì…(`blob`)ì„
    - `setBinaryStream()`, `setBlob()`, `setBytes()` ë©”ì†Œë“œ ì¤‘ í•˜ë‚˜ë¥¼ ì´ìš©

<br>

- 4ï¸âƒ£ `INSERT` ë¬¸ì„ ì‹¤í–‰í•˜ê³  ì €ì¥ëœ **`bno`** ê°’ì„ ì–»ëŠ” ë°©ë²•

      int rows = pstmt.executeUpdate();              // SQLë¬¸ ì‹¤í–‰
       if(rows == 1) {
       ResultSet rs = pstmt.getGeneratedKeys();      // new String[] { "bno" }ì— ê¸°ìˆ ëœ ì»¬ëŸ¼ ê°’ì„ ê°€ì ¸ì˜´

       if(rs.next()) {                               // ê°’ì´ ìˆë‹¤ë©´
         int bno = rs.getInt(1);                     // new String[] { "bno" }ì˜ ì²« ë²ˆì§¸ í•­ëª© bnoì˜ ì»¬ëŸ¼ ê°’ì„ ì½ìŒ
       }
      rs.close();                                    // ResultSetì´ ì‚¬ìš©í–ˆë˜ ë©”ëª¨ë¦¬ í•´ì œ
      }

<br>

[ğŸ”— BoardInsertExample](https://github.com/NOSTALJIAN/JAVA/blob/b36db64ce973bb6ecab78d9426b3bcec6b3109ad/Jian/jdbc/day01/BoardInsertExample.java)

<br>

![boardsí…Œì´ë¸”_ì ìš©ì‚¬ì§„_1_MySQL](/IMAGE/thisisjava_boards_1.png)
![boardsí…Œì´ë¸”_ì ìš©ì‚¬ì§„_2_MySQL](/IMAGE/thisisjava_boards_2.png)

<br>

---

<br>